include('../auto')
class Fight {
	private static _aliveEnemies
	private static _aliveAllies
	private static _aliveAll
	static allEntitiesId
	static self

	static refresh(){
		_aliveEnemies = []
		_aliveAllies = []
		_aliveAll = []
		allEntitiesId = []
		for(var e in getAliveEnemies()) {
			var entity = Entity(e)
			_aliveEnemies[e] = entity
			_aliveAll[e] = entity
		}
		for(var a in getAliveAllies()) {
			var entity = Entity(a)
			_aliveAllies[a] = entity
			_aliveAll[a] = entity
		}
		self = _aliveAll[getLeek()]
		for(var entity in _aliveAll){
			entity.init()
			push(allEntitiesId, entity.id)
		}
	}

	static getEntity(entityId) {
		return _aliveAll[entityId]
	}
	
	static getEnemiesAlive() {
		return _aliveEnemies
	}
	static getAlliesAlive() {
		return _aliveAllies
	}
	static getAllAlive() {
		return _aliveAll
	}
	
	// TODO: cette fonction return une list avec <entity> inclus actuellement, ça ne devrait pas, FIX IT
	static getListOfLeekWhoPlayBefore(entity) {
		if(entity == self) return []
		var list = [self]
		var self = self.turnOrder
		var limit = entity.turnOrder
		for(var e in _aliveAll) {
			if(self < limit){
				if(self < e.turnOrder && e.turnOrder < limit) push(list, e)
			} else {
				if(self < e.turnOrder) push(list, e)
				if(e.turnOrder < limit) push(list, e)
			}
		}
		return list;
	}
}